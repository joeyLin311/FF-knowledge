#browser 
进程: 进程就是一个程序的运行实例

线程: 可以理解为执行任务的队列

以前的浏览器是单进程的产物, 页面渲染, JS执行, 插件, 网路之类的都运行在同一个进程中, 会导致一下几个问题:
1.  **不稳定**, 早期浏览器借助插件来实现web功能, 插件是比较容易出问题的, 比如IE的 Activat什么什么插件, 很容易崩溃, 一旦出问题就会引起整个浏览器的崩溃
2.  **不流畅**, 因为页面渲染, JS执行都在同一线程中, 意味着同一个时间段只能有一个模块可以执行, 挤占了其它任务执行的时间, 导致很多页面出现失去相应, 变卡顿等.
3.  **不安全**, 插件用C++等语言编写, 这就使插件可以获取到操作系统的任意资源, 没有沙箱隔离机制, 浏览器安全就形同虚设

### 多进程浏览器(以chrome为代表)
现代浏览器一般采用多进程架构, 以chrome为例, 在浏览器中主要有以下几个进程:
1.  **浏览器主进程** : 主要负责界面显示, 用户交互, 子进程管理, 提供用户存储等功能
2.  **渲染进程** : 页面显示的关键进程, 主要将HTML, CSS, javaScript 转化为页面, 使用排版引擎和JS V8引擎处理该类工作, 默认情况下, chrome的一个tab就是一个渲染进程. 渲染进程运行在沙箱模式下
3.  GPU进程 : 最初为了实现 3D CSS, 后来UI页面也使用GPU进行渲染, 所以有了这个进程
4.  **网络进程** : 主要负责网络资源加载, 也就是network面板里面看到的所有服务端资源请求都是由该进程负责
5.  插件进程 : 负责插件运行, 插件有奔溃的风险, 所以单独拎出来为一个进程做隔离, 保证页面和浏览器不会受插件出问题而影响

### 从输入URL 开始发生的步骤
-   输入URL , 解析URL , 组装协议, 构成完整URL
-   **浏览器进程**通过进程间通信(IPC) 把URL请求发送给**网络进程**
-   **网络进程**接收到URL请求后检查本地缓存查看资源缓存情况, 进行资源返回或者重新请求服务器资源
-   如果需要进行服务器发起HTTP请求, 则走如下流程
	-   进行DNS解析, 获取服务器IP地址
	-   建立TCP连接
	-   构建请求头, 发送请求头
	-   服务器响应, 浏览器接收资源然后解析资源
-   准备**渲染进程**
	-   **浏览器进程**检查当前URL是否和已打开的tab页面是否 same-site, 如果相同, 则复用已有的进程, 如果不同, 则开启新的**渲染进程**
-   传输数据, 更新状态
	-   **渲染进程**准备好之后, 浏览器向渲染进程发起"提交文档"的消息, 渲染进程接收到消息后和网络进程建立传输数据的"管道"
	-   **渲染进程** 接收完数据后, 向浏览器进程发送"确认提交"
	-   **浏览器进程**接收到确认消息后更新浏览器界面状态, 有以下: 安全, 地址栏URL, 页面栈历史状态, 更新web页面