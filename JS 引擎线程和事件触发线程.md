---
date created: 2021-12-09 22:55
date updated: 2021-12-17 16:12
---

#browser
浏览器页面初次渲染完成后, **JS 引擎线程**结合**事件触发线程**的工作流程如下:

1. 同步任务在 JS 引擎线程(主线程)上执行, 形成**执行栈**(Execution Context Stack)
2. 在主线程之外, **事件触发线程**管理着一个任务队列(Task Queue). 只要异步任务有了运行结果, 就在**任务队列**之中放置一个事件
3. **执行栈**中的同步任务执行完毕, 系统就会读取**任务队列**, 如果有异步任务需要执行, 将其加到主线程的**执行栈**执行相应的异步任务.

关于该线程之间的协同工作形成了浏览器运行环境中代码的**事件循环机制** [[EventLoop 事件循环]], 对此引申出的宏任务与微任务的概念, 有以下理解:

- 宏任务中的事件是由**事件触发线程**维护的
- 微任务中的所有任务是由**JS 引擎线程**维护的, 这是一种猜测, 因为宏任务执行完毕后会立即执行微任务, 为了提升性能, 这种无缝衔接的操作放在**事件触发线程**中维护是不合理的
