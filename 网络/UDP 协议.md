---
date created: 2021-12-09 22:54
date updated: 2021-12-17 16:19
---

#Network

## UDP 概念
用户数据报协议（英语：User Datagram Protocol，缩写：UDP；又称用户数据包协议）是一个简单的面向 [数据报](https://zh.wikipedia.org/wiki/%E6%95%B0%E6%8D%AE%E6%8A%A5) 的 [通信协议](https://zh.wikipedia.org/wiki/%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE) ，位于 [OSI模型](https://zh.wikipedia.org/wiki/OSI%E6%A8%A1%E5%9E%8B) 的 [传输层](https://zh.wikipedia.org/wiki/%E4%BC%A0%E8%BE%93%E5%B1%82) 。该协议由David P. Reed在1980年设计且在RFC 768中被规范。典型网络上的众多使用UDP协议的关键应用在一定程度上是相似的。
### [[HTTP3 协议]]

在 [TCP/IP](https://zh.wikipedia.org/wiki/TCP/IP) 模型中，UDP为 [网络层](https://zh.wikipedia.org/wiki/%E7%BD%91%E7%BB%9C%E5%B1%82) 以上和 [应用层](https://zh.wikipedia.org/wiki/%E5%BA%94%E7%94%A8%E5%B1%82) 以下提供了一个简单的接口。UDP只提供 [数据](https://zh.wikipedia.org/wiki/%E6%95%B0%E6%8D%AE) 的不可靠传递，它一旦把应用程序发给网络层的数据发送出去，就不保留数据备份（所以UDP有时候也被认为是不可靠的数据报协议）。UDP在IP数据报的头部仅仅加入了复用和数据校验字段。

1. UDP 是一个**无连接的**协议，传输数据之前源端和终端不建立连接， 当它想传送时就简单地去抓取来自应用程序的数据，并尽可能快地把它扔到网络上。 在发送端，UDP 传送数据的速度仅仅是受应用程序生成数据的速度、 计算机的能力和传输带宽的限制； 在接收端，UDP 把每个消息段放在队列中，应用程序每次从队列中读一个消息段。
2. 由于传输数据不建立连接，因此也就不需要维护连接状态，包括收发状态等， 因此一台服务机可同时向多个客户机传输相同的消息。
3. UDP 信息包的标题很短**首部开销小**，只有 8 个字节，相对于 TCP 的 20 个字节信息包的额外开销很小。
4. 吞吐量不受拥挤控制算法的调节，只受应用软件生成数据的速率、传输带宽、 源端和终端主机性能的限制。
5. UDP 使用**尽最大努力交付**，即不保证可靠交付， 因此主机不需要维持复杂的链接状态表（这里面有许多参数）。
6. UDP 是**面向报文**的。发送方的 UDP 对应用程序交下来的报文， 在添加首部后就向下交付给 IP 层。既不拆分，也不合并，而是保留这些报文的边界， 因此，应用程序需要选择合适的报文大小。
7. UDP **没有拥塞控制**，网络出现的拥塞不会使源主机的发送速率降低。这对某些实时应用是很重要的
8. UDP 支持一对一、一对多、多对一和多对多的交互通信

### UDP 适用场景

- UDP 协议一般作为流媒体应用、语音交流、视频会议所使用的传输层协议，还有许多基于互联网的电话服务使用的 VOIP（基于 IP 的语音）也是基于 UDP 运行的，实时视频和音频流协议旨在处理偶尔丢失的数据包，因此，如果重新传输丢失的数据包，则只会发生质量略有下降，而不是出现较大的延迟。
- 我们大家都知道的 DNS 协议底层也使用了 UDP 协议，这些应用或协议之所以选择 UDP 主要是因为以下这几点
- 速度快，采用 UDP 协议时，只要应用进程将数据传给 UDP，UDP 就会将此数据打包进 UDP 报文段并立刻传递给网络层，然而 TCP 有拥塞控制的功能，它会在发送前判断互联网的拥堵情况，如果互联网极度阻塞，那么就会抑制 TCP 的发送方。使用 UDP 的目的就是希望实时性。
- 无须建立连接，TCP 在数据传输之前需要经过三次握手的操作，而 UDP 则无须任何准备即可进行数据传输。因此 UDP 没有建立连接的时延。
- 无连接状态，TCP 需要在端系统中维护连接状态，连接状态包括接收和发送缓存、拥塞控制参数以及序号和确认号的参数，在 UDP 中没有这些参数，也没有发送缓存和接受缓存。因此，某些专门用于某种特定应用的服务器当应用程序运行在 UDP 上，一般能支持更多的活跃用户
- 分组首部开销小，每个 TCP 报文段都有 20 字节的首部开销，而 UDP 仅仅只有 8 字节的开销。

### 小结 TCP 与 UDP 的区别：

- 基于连接与无连接；
- 对系统资源的要求（TCP 较多，UDP 少）；
- UDP 程序结构较简单；
- 流模式与数据报模式 ；
- TCP 保证数据正确性，UDP 可能丢包；
- TCP 保证数据顺序，UDP 不保证。

TCP 是一个面向字节流的协议，能够以多个分组形式发送应用程序消息，且对分组中的消息范围没有任何明确限制。因此两端通信存在一个连接状态，每个分组都有序号，丢失需要重发，并且要按照顺序交付。

UDP 是一个简单的、无状态的协议，适合作业